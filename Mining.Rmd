---
title: "Text_Mining"
output: html_document
date: "2023-03-13"
---

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(readxl)
library(tesseract)
library(pdftools)
```


```{r message=FALSE, warning=FALSE}
Translation_extraction <- read_excel("Translation-extraction.xlsx", 
    sheet = "Analysis")
Translation_extraction <- Translation_extraction[-1,]
rename_cols <- read_excel("rename_cols.xlsx")
Translation_extraction <- Translation_extraction %>%
  select(Study,DOI,Rob_protocol,Rob_search:Rob_guidelines,Rob_inexclusioncriteria:Rob_coi)
```

Dictionaries: 0=no, 1=yes, 2=not reported
Rob_protocol:	Does the study follow a pre-specified protocol?
Rob_search:	Was the search strategy comprehensive? The search should cover at least 2 different data bases.
Rob_extraction:	Data extraction must have been performed by at least two reviewers.
Rob_rob:	Did the study assess risk of bias for eligible studies? (independent of employed tool)
Rob_guidelines:	Study in accordance with systematic review guidelines? Mentioning of either PRISMA, QUOROM, SYRCLE, or CAMARADES.
Rob_inexclusioncriteria:	Are in- and exclusion criteria for studies listed?
Rob_flowchart:	Is there a flow chart provided?
Rob_coi:	Do the authors mention whether there is a conflict of interest?

```{r message=FALSE, warning=FALSE}
dict_rob<-c("PRISMA|QUOROM|SYRCLE|CAMARADES")

names<-list.files("Included-fulltexts-PDF")[1:20]
data<-data.frame()

for(i in names){
  path<-paste0("Included-fulltexts-PDF/",i)
  pdf_text <- pdf_text(path)

  text_vector <- paste(pdf_text, collapse = " ")

  df<-data.frame(text=text_vector) %>% 
  mutate(title=i,RoB=ifelse(grepl(dict_rob,text),0,1)) %>% 
  select(RoB,title)
  
  data<-rbind(data,df)
}
```




```{r}
Translation_extraction %>%
  mutate(across(starts_with("Rob_"), ~gsub("2","0",.)))
```


```{r}
text<-pdf_text(paste0("Included-fulltexts-PDF/",names[[1]]))
gsub("  ","",text)


read.pdf.EE(paste0("Included-fulltexts-PDF/",names[[1]]))
```


